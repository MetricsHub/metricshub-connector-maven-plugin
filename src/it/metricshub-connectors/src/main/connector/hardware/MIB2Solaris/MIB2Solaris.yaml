---
extends:
- ../Hardware/Hardware
- ../MIB2-header/MIB2-header
- ../SunEthernetDriver-header/SunEthernetDriver-header
connector:
  displayName: MIB-2 Standard SNMP Agent - Network Interfaces - Solaris
  platforms: Any system with SNMP
  detection:
    appliesTo:
    - Solaris
    supersedes:
    - SunNetwork
monitors:
  network:
    discovery:
      sources:
        source(1):
          computes:
            # Process that through an AWK script to use Description as the device ID
            # and isolate the driver name, so we can translate that into a card model
            # Also keep only cards where the first word is a purely alphanumeric driverInstance name
            # DeviceID;DriverName;PortType;MacAddress;AdminStatus;
          - type: awk
            script: "${file::embeddedFile-1}"
            keep: ^MSHW;
            separators: ;
            selectColumns: "2,3,4,5,6"
            # Translate the Driver column into a model name
            # DeviceID;Model;PortType;MacAddress;AdminStatus;
          - type: translate
            column: 2
            translationTable: "${translation::DriverTranslationTable}"
      mapping:
        # InstanceTable = Source(1)
        # PortID;Description;PortType;MacAddress;AdminStatus;
        source: "${source::monitors.network.discovery.sources.source(1)}"
        attributes:
          id: $1
          vendor: $2
          physical_address: $4
          physical_address_type: MAC
          device_type: $3
          hw.parent.type: enclosure
          name: "${awk::sprintf(\"%s (%s - %s)\", $1, $3, $2)}"
    collect:
      sources:
        source(6):
          computes:
            # Same as in the discovery, use Description as the DeviceID
            # PortID;Description;SpeedMBps;PATROLStatus;StatusInformation;LinkStatus;ReceivedBytes;ReceivedPackets;ReceivedNonUnicastPackets;TotalErrors;TransmittedBytes;TransmittedPackets;TransmittedNonUnicastPackets;TransmittedErrors;
          - type: replace
            column: 1
            existingValue: $1
            newValue: $2
